<div class="page-header">
	<h1>Cupones  <span class="glyphicon glyphicon-tag"></span></h1>
</div>
<div class="container" style="margin-top: 20px; margin-bottom: 20px;" ng-switch on="cupones.length">
	<ul ng-switch-when="0">
		<li><em>No hay cupones guardados. ¿Quieres <a href="#/new">registrar un cupón</a>?</li>
	</ul>
	<div class="row panel" ng-repeat="cupon in cupones">
		<div class="col-md-4">
			<img ng-src="{{cupon.binaryImage}}" class="thumbnail" alt="{{cupon.nombre}}"/>
			<blockquote>
				<p><strong>Válido hasta: </strong>{{cupon.fecha_validez}}</p>
  				<hr>
  				<h4>Califica: </h4><rating class="color-star" style="font-size: 1.5em" ng-model="rate" max="5" readonly="false" on-hover="hoveringOver(value)"></rating>
			</blockquote>
		</div>
        <div class="col-md-8 col-xs-12" ng-switch on="cupon.comentarios.length">
        	<div ng-switch-when="0" class='alert alert-warning' role='alert' >
				<p>Sin comentarios</p>
			</div>
            <div class="comments-list" ng-switch-default>				
            	<div class="media" ng-repeat="comment in cupon.comentarios | slice:start:end">
					<p class="pull-right"><small>{{comment.fecha}}</small></p>
					<a class="media-left" href="#">
						<img class="avatar" ng-src="data:{{comment.id_usuario.extension_avatar}};base64,{{comment.id_usuario.avatar_binary}}">
					</a>
					<div class="media-body">
						<h4 class="media-heading user_name">{{comment.id_usuario.nombre}} {{comment.id_usuario.ap_paterno}}</h4>
						{{comment.descripcion}}
					</div>
				</div>
        	</div>
        	<div style="cursor: pointer;" ng-show="cupon.comentarios.length > end" ng-click="vieMoreComents()">
				<h5 class="text-center"><span class="glyphicon glyphicon-plus-sign"></span> Ver más comentarios</h5>
			</div>
	  		<div class="input-group">
      			<input type="text" name="comentario" ng-model="comentario" class="form-control" id="comentario" placeholder="Comentar">
   				<span class="input-group-btn">
     				<button type="button" class="btn btn-primary" ng-click="doComment(cupon._id, comentario, cupon.comentarios)">
     					<span class="glyphicon glyphicon-comment"></span> Comentar
     				</button>
   				</span>
   			</div>
   			<br/>
        </div>
    </div>
</div>